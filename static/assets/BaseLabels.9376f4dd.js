import{s as e}from"./request.0c690da8.js";import{p as l,b as a,r as t,o as i,c as s,a as o,h as d,j as n,t as r,k as h,w as b}from"./vendor.61ee7ef1.js";const c={name:"baseLabels",data:()=>({baseLabels:[],addLabelInfo:{id:0,label:""},pageSize:15,pageTotal:0,currentPage:1,searchContent:"",deleteVisible:{},dialogVisible:!1,buttonTitle:"",dialogTitle:"",rules:{label:[{required:!0,message:"请输入正确的分组名称",validator:function(e,l,a){if(""===l||void 0===l||null==l)a(new Error("请输入正确名称"));else{/\s+/.test(l)?a(new Error("名称中不允许有空字符")):a()}},trigger:["blur"]}]}}),created(){},mounted(){this.doGetBaseLabels()},methods:{doAdd(){this.addLabelInfo={label:"",port:0,display_order:1},this.buttonTitle="创建",this.dialogTitle="增加标签",this.dialogVisible=!0},doGetBaseLabels(l){var a;l||(l={pageNo:this.currentPage,pageSize:this.pageSize,search:this.searchContent}),(a=l,e({url:"/v1/base/labels",method:"get",params:a})).then((e=>{this.baseLabels=e.data.data,this.pageTotal=e.data.totalCount,this.currentPage=e.data.pageNo,this.pageSize=e.data.pageSize})).catch((e=>{console.log(e)}))},doEdit(e){this.buttonTitle="更新",this.dialogTitle="编辑标签",this.addLabelInfo.id=e.row.id,this.addLabelInfo.label=e.row.label,this.dialogVisible=!0},handleSizeChange(e){let l={pageNo:this.currentPage,pageSize:e,search:this.searchContent};this.doGetBaseLabels(l)},handleCurrentChange(e){let l={pageNo:e,pageSize:this.pageSize,search:this.searchContent};this.doGetBaseLabels(l)},handleClose(e){this.dialogVisible=!1},onSubmit(l){this.$refs[l].validate((a=>{if(!a)return!1;{let a={};a.label=this.addLabelInfo.label,"创建"===this.buttonTitle?(t=a,e({url:"/v1/base/labels",method:"post",data:t})).then((e=>{this.$notify({title:"成功",message:"创建成功！",type:"success"}),this.doGetBaseLabels(),this.dialogVisible=!1,this.$refs[l].resetFields()})).catch((e=>{console.log(e)})):(a.id=this.addLabelInfo.id,function(l){return e({url:"/v1/base/labels",method:"put",data:l})}(a).then((e=>{this.$notify({title:"成功",message:"更新成功！",type:"success"}),this.doGetBaseLabels(),this.dialogVisible=!1,this.$refs[l].resetFields()})).catch((e=>{console.log(e)})))}var t}))},onCancel(e){this.dialogVisible=!1,this.$refs[e].resetFields()},onSearch(){this.doGetBaseLabels()},parseTimeSelf(e){var l=new Date(Date.parse(e));return l.toLocaleDateString()+" "+l.toTimeString().split(" ")[0]},doYes(l){var a;(a={id:l.row.id},e({url:"/v1/base/labels",method:"delete",params:a})).then((e=>{this.$notify({title:"成功",message:"删除成功！",type:"success"}),this.doGetBaseLabels()})).catch((e=>{console.log(e)})),this.deleteVisible[l.$index]=!1},doNo(e){this.deleteVisible[e.$index]=!1},doDelete(e){this.deleteVisible[e.$index]=!0},rowStyle:e=>({padding:"0"}),cellStyle:e=>({padding:"0"}),invocate(l){const a=!this.baseLabels[l.$index].enabled,t={id:l.row.id,enabled:a};var i;(i=t,e({url:"/v1/base/labels/status",method:"put",data:i})).then((e=>{this.$notify({title:"成功",message:"更新状态成功！",type:"success"}),this.baseLabels[l.$index].enabled=a,this.baseLabels=[...this.baseLabels]})).catch((e=>console.log(e)))}}},p=b();l("data-v-317db2c3");const u={class:"main-board"},g={class:"do_action"},m={style:{"padding-right":"15px"}},f=n("添加"),C={class:"actioneara"},y=n("编辑"),v=n("禁用"),z=n("启用"),L=o("p",null,"确定删除吗？",-1),S={style:{"text-align":"right",margin:"0"}},_=n("取消"),V=n("确定"),w=n("删除"),k={class:"block"},x=n("取消");a();const T=p(((e,l,a,b,c,T)=>{const $=t("el-button"),I=t("el-input"),B=t("el-table-column"),G=t("el-popover"),N=t("el-table"),D=t("el-pagination"),P=t("el-form-item"),j=t("el-form"),E=t("el-dialog");return i(),s("div",u,[o("div",g,[o("div",m,[o($,{size:"small",type:"success",plain:"",onClick:l[1]||(l[1]=e=>T.doAdd())},{default:p((()=>[f])),_:1})]),o("div",null,[o("div",null,[o(I,{size:"small",placeholder:"请输入内容",modelValue:c.searchContent,"onUpdate:modelValue":l[3]||(l[3]=e=>c.searchContent=e),onKeyup:l[4]||(l[4]=d((e=>T.onSearch()),["enter"]))},{append:p((()=>[o($,{size:"small",onClick:l[2]||(l[2]=e=>T.onSearch()),icon:"el-icon-search"})])),_:1},8,["modelValue"])])])]),o(N,{size:"mini","highlight-current-row":"",border:"",data:c.baseLabels,stripe:"","row-style":T.rowStyle,"cell-style":T.cellStyle},{default:p((()=>[o(B,{label:"序号",width:"50px"},{default:p((e=>[n(r(e.$index+1),1)])),_:1}),o(B,{label:"标签名称",prop:"label"}),o(B,{label:"最后更新时间",prop:"update_at"},{default:p((({row:e})=>[o("span",null,r(T.parseTimeSelf(e.update_at)),1)])),_:1}),o(B,{label:"操作",align:"center",width:"210px"},{default:p((e=>[o("div",C,[o("div",null,[o($,{size:"mini",type:"primary",onClick:l=>T.doEdit(e),plain:""},{default:p((()=>[y])),_:2},1032,["onClick"])]),o("div",null,[!0===e.row.enabled?(i(),s($,{key:0,size:"mini",type:"info",onClick:l=>T.invocate(e),plain:""},{default:p((()=>[v])),_:2},1032,["onClick"])):h("",!0),!1===e.row.enabled?(i(),s($,{key:1,size:"mini",type:"warning",onClick:l=>T.invocate(e),plain:""},{default:p((()=>[z])),_:2},1032,["onClick"])):h("",!0)]),o("div",null,[o(G,{visible:c.deleteVisible[e.$index],placement:"top"},{reference:p((()=>[o($,{size:"mini",type:"danger",plain:"",onClick:l=>T.doDelete(e)},{default:p((()=>[w])),_:2},1032,["onClick"])])),default:p((()=>[L,o("div",S,[o($,{size:"mini",type:"text",onClick:l=>T.doNo(e)},{default:p((()=>[_])),_:2},1032,["onClick"]),o($,{type:"primary",size:"mini",onClick:l=>T.doYes(e)},{default:p((()=>[V])),_:2},1032,["onClick"])])])),_:2},1032,["visible"])])])])),_:1})])),_:1},8,["data","row-style","cell-style"]),o("div",k,[o(D,{onSizeChange:T.handleSizeChange,onCurrentChange:T.handleCurrentChange,"current-page":c.currentPage,"page-sizes":[10,15,30,50],"page-size":c.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:c.pageTotal},null,8,["onSizeChange","onCurrentChange","current-page","page-size","total"])]),o(E,{title:c.dialogTitle,modelValue:c.dialogVisible,"onUpdate:modelValue":l[8]||(l[8]=e=>c.dialogVisible=e),width:"400px",modal:"","before-close":T.handleClose},{default:p((()=>[o("span",null,[o(j,{"label-position":"right",rules:c.rules,ref:"addLabelInfo",model:c.addLabelInfo,"label-width":"90px",size:"small"},{default:p((()=>[o(P,{label:"标签名：",prop:"label"},{default:p((()=>[o(I,{style:{width:"230px"},modelValue:c.addLabelInfo.label,"onUpdate:modelValue":l[5]||(l[5]=e=>c.addLabelInfo.label=e)},null,8,["modelValue"])])),_:1}),o(P,{size:"small"},{default:p((()=>[o($,{size:"small",type:"primary",onClick:l[6]||(l[6]=e=>T.onSubmit("addLabelInfo"))},{default:p((()=>[n(r(c.buttonTitle),1)])),_:1}),o($,{size:"small",type:"info",onClick:l[7]||(l[7]=e=>T.onCancel("addLabelInfo"))},{default:p((()=>[x])),_:1})])),_:1})])),_:1},8,["rules","model"])])])),_:1},8,["title","modelValue","before-close"])])}));c.render=T,c.__scopeId="data-v-317db2c3";export default c;
