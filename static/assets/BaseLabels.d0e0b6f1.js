import{s as e}from"./request.3493418b.js";import{p as a,j as l,r as t,o as i,c as s,a as o,w as n,l as d,t as r,q as b,k as h}from"./vendor.02dbbba7.js";import"./index.0f704aaa.js";const p={name:"baseLabels",data:()=>({baseLabels:[],addLabelInfo:{id:0,label:""},pageSize:15,pageTotal:0,currentPage:1,searchContent:"",deleteVisible:{},dialogVisible:!1,buttonTitle:"",dialogTitle:"",rules:{label:[{required:!0,message:"请输入正确的标签名称",validator:function(e,a,l){if(""===a||void 0===a||null==a)l(new Error("请输入正确名称"));else{/\s+/.test(a)?l(new Error("名称中不允许有空字符")):l()}},trigger:["blur"]}]}}),created(){},mounted(){this.doGetBaseLabels()},methods:{doAdd(){this.addLabelInfo={label:"",port:0,display_order:1},this.buttonTitle="创建",this.dialogTitle="增加标签",this.dialogVisible=!0},doGetBaseLabels(a){var l;a||(a={pageNo:this.currentPage,pageSize:this.pageSize,search:this.searchContent}),(l=a,e({url:"/v1/base/labels",method:"get",params:l})).then((e=>{this.baseLabels=e.data.data,this.pageTotal=e.data.totalCount,this.currentPage=e.data.pageNo,this.pageSize=e.data.pageSize})).catch((e=>{console.log(e)}))},doEdit(e){this.buttonTitle="更新",this.dialogTitle="编辑标签",this.addLabelInfo.id=e.row.id,this.addLabelInfo.label=e.row.label,this.dialogVisible=!0},handleSizeChange(e){let a={pageNo:this.currentPage,pageSize:e,search:this.searchContent};this.doGetBaseLabels(a)},handleCurrentChange(e){let a={pageNo:e,pageSize:this.pageSize,search:this.searchContent};this.doGetBaseLabels(a)},handleClose(e){this.dialogVisible=!1},onSubmit(a){this.$refs[a].validate((l=>{if(!l)return!1;{let l={};l.label=this.addLabelInfo.label,"创建"===this.buttonTitle?(t=l,e({url:"/v1/base/labels",method:"post",data:t})).then((e=>{this.$notify({title:"成功",message:"创建成功！",type:"success"}),this.doGetBaseLabels(),this.dialogVisible=!1,this.$refs[a].resetFields()})).catch((e=>{console.log(e)})):(l.id=this.addLabelInfo.id,function(a){return e({url:"/v1/base/labels",method:"put",data:a})}(l).then((e=>{this.$notify({title:"成功",message:"更新成功！",type:"success"}),this.doGetBaseLabels(),this.dialogVisible=!1,this.$refs[a].resetFields()})).catch((e=>{console.log(e)})))}var t}))},onCancel(e){this.dialogVisible=!1,this.$refs[e].resetFields()},onSearch(){this.doGetBaseLabels()},parseTimeSelf(e){var a=new Date(Date.parse(e));return a.toLocaleDateString()+" "+a.toTimeString().split(" ")[0]},doYes(a){var l;(l={id:a.row.id},e({url:"/v1/base/labels",method:"delete",params:l})).then((e=>{this.$notify({title:"成功",message:"删除成功！",type:"success"}),this.doGetBaseLabels()})).catch((e=>{console.log(e)})),this.deleteVisible[a.$index]=!1},doNo(e){this.deleteVisible[e.$index]=!1},doDelete(e){this.deleteVisible[e.$index]=!0},rowStyle:e=>({padding:"0"}),cellStyle:e=>({padding:"0"}),invocate(a){const l=!this.baseLabels[a.$index].enabled,t={id:a.row.id,enabled:l};var i;(i=t,e({url:"/v1/base/labels/status",method:"put",data:i})).then((e=>{this.$notify({title:"成功",message:"更新状态成功！",type:"success"}),this.baseLabels[a.$index].enabled=l,this.baseLabels=[...this.baseLabels]})).catch((e=>console.log(e)))}}},c=h();a("data-v-1b2e1236");const u={class:"main-board"},g={class:"btn-action-area"},m={class:"explain-words"},f=d(" 说明：定义的标签（key/value）可以在"),C=d("JOB组管理"),y=d("和"),v=d("告警管理"),z=d("中使用"),L={class:"do_action"},_={style:{"padding-right":"15px"}},S=d("添加标签"),w={class:"actioneara"},V=d("编辑"),k=d("禁用"),x=d("启用"),T=o("p",null,"确定删除吗？",-1),$={style:{"text-align":"right",margin:"0"}},I=d("取消"),B=d("确定"),G=d("删除"),N={class:"block"},j=d("取消");l();const D=c(((e,a,l,h,p,D)=>{const P=t("el-tag"),E=t("el-button"),q=t("el-input"),F=t("el-table-column"),U=t("el-popover"),A=t("el-table"),Y=t("el-pagination"),J=t("el-form-item"),K=t("el-form"),O=t("el-dialog");return i(),s("div",u,[o("div",g,[o("div",null,[o("span",m,[f,o(P,{size:"mini"},{default:c((()=>[C])),_:1}),y,o(P,{size:"mini"},{default:c((()=>[v])),_:1}),z])]),o("div",L,[o("div",_,[o(E,{size:"small",type:"success",plain:"",onClick:a[1]||(a[1]=e=>D.doAdd())},{default:c((()=>[S])),_:1})]),o("div",null,[o("div",null,[o(q,{size:"small",placeholder:"请输入内容",modelValue:p.searchContent,"onUpdate:modelValue":a[3]||(a[3]=e=>p.searchContent=e),onKeyup:a[4]||(a[4]=n((e=>D.onSearch()),["enter"]))},{append:c((()=>[o(E,{size:"small",onClick:a[2]||(a[2]=e=>D.onSearch()),icon:"el-icon-search"})])),_:1},8,["modelValue"])])])])]),o(A,{size:"mini","highlight-current-row":"",border:"",data:p.baseLabels,stripe:"","row-style":D.rowStyle,"cell-style":D.cellStyle},{default:c((()=>[o(F,{label:"序号",width:"50px"},{default:c((e=>[d(r(e.$index+1),1)])),_:1}),o(F,{label:"标签名称",prop:"label"}),o(F,{label:"最后更新账号",prop:"update_by"}),o(F,{label:"最后更新时间",prop:"update_at"},{default:c((({row:e})=>[o("span",null,r(D.parseTimeSelf(e.update_at)),1)])),_:1}),o(F,{label:"操作",align:"center",width:"210px"},{default:c((e=>[o("div",w,[o("div",null,[o(E,{size:"mini",type:"primary",onClick:a=>D.doEdit(e),plain:""},{default:c((()=>[V])),_:2},1032,["onClick"])]),o("div",null,[!0===e.row.enabled?(i(),s(E,{key:0,size:"mini",type:"info",onClick:a=>D.invocate(e),plain:""},{default:c((()=>[k])),_:2},1032,["onClick"])):b("",!0),!1===e.row.enabled?(i(),s(E,{key:1,size:"mini",type:"warning",onClick:a=>D.invocate(e),plain:""},{default:c((()=>[x])),_:2},1032,["onClick"])):b("",!0)]),o("div",null,[o(U,{visible:p.deleteVisible[e.$index],placement:"top"},{reference:c((()=>[o(E,{size:"mini",type:"danger",plain:"",onClick:a=>D.doDelete(e)},{default:c((()=>[G])),_:2},1032,["onClick"])])),default:c((()=>[T,o("div",$,[o(E,{size:"mini",type:"text",onClick:a=>D.doNo(e)},{default:c((()=>[I])),_:2},1032,["onClick"]),o(E,{type:"primary",size:"mini",onClick:a=>D.doYes(e)},{default:c((()=>[B])),_:2},1032,["onClick"])])])),_:2},1032,["visible"])])])])),_:1})])),_:1},8,["data","row-style","cell-style"]),o("div",N,[o(Y,{onSizeChange:D.handleSizeChange,onCurrentChange:D.handleCurrentChange,"current-page":p.currentPage,"page-sizes":[10,15,30,50],"page-size":p.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:p.pageTotal},null,8,["onSizeChange","onCurrentChange","current-page","page-size","total"])]),o(O,{title:p.dialogTitle,modelValue:p.dialogVisible,"onUpdate:modelValue":a[8]||(a[8]=e=>p.dialogVisible=e),width:"400px",modal:"","before-close":D.handleClose},{default:c((()=>[o("span",null,[o(K,{"label-position":"right",rules:p.rules,ref:"addLabelInfo",model:p.addLabelInfo,"label-width":"90px",size:"small"},{default:c((()=>[o(J,{label:"标签名：",prop:"label"},{default:c((()=>[o(q,{style:{width:"230px"},modelValue:p.addLabelInfo.label,"onUpdate:modelValue":a[5]||(a[5]=e=>p.addLabelInfo.label=e)},null,8,["modelValue"])])),_:1}),o(J,{size:"small"},{default:c((()=>[o(E,{size:"small",type:"primary",onClick:a[6]||(a[6]=e=>D.onSubmit("addLabelInfo"))},{default:c((()=>[d(r(p.buttonTitle),1)])),_:1}),o(E,{size:"small",type:"info",onClick:a[7]||(a[7]=e=>D.onCancel("addLabelInfo"))},{default:c((()=>[j])),_:1})])),_:1})])),_:1},8,["rules","model"])])])),_:1},8,["title","modelValue","before-close"])])}));p.render=D,p.__scopeId="data-v-1b2e1236";export default p;
