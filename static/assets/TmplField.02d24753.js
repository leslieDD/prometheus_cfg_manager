import{s as e}from"./request.3493418b.js";import{p as l,j as t,r as i,o as a,c as s,a as d,w as o,l as n,t as r,q as p,k as u}from"./vendor.02dbbba7.js";import"./index.0f704aaa.js";const h={name:"tmplFields",data(){function e(e,l,t){if(""===l||void 0===l||null==l)t(new Error("请输入正确名称"));else{/\s+/.test(l)?t(new Error("名称中不允许有空字符")):t()}}return{tmplFields:[],addTmplFields:{id:0,label:""},pageSize:15,pageTotal:0,currentPage:1,searchContent:"",deleteVisible:{},dialogVisible:!1,buttonTitle:"",dialogTitle:"",rules:{key:[{required:!0,message:"请输入正确的字段名称",validator:e,trigger:["blur"]}],value:[{required:!0,message:"请输入正确的字段值",validator:e,trigger:["blur"]}]}}},created(){},mounted(){this.doGetBaseFields()},methods:{doAdd(){this.addTmplFields={key:"",value:""},this.buttonTitle="创建",this.dialogTitle="增加字段",this.dialogVisible=!0},doGetBaseFields(l){var t;l||(l={pageNo:this.currentPage,pageSize:this.pageSize,search:this.searchContent}),(t=l,e({url:"/v1/base/fields",method:"get",params:t})).then((e=>{this.tmplFields=e.data.data,this.pageTotal=e.data.totalCount,this.currentPage=e.data.pageNo,this.pageSize=e.data.pageSize})).catch((e=>{console.log(e)}))},doEdit(e){this.buttonTitle="更新",this.dialogTitle="编辑字段",this.addTmplFields.id=e.row.id,this.addTmplFields.key=e.row.key,this.addTmplFields.value=e.row.value,this.dialogVisible=!0},handleSizeChange(e){let l={pageNo:this.currentPage,pageSize:e,search:this.searchContent};this.doGetBaseFields(l)},handleCurrentChange(e){let l={pageNo:e,pageSize:this.pageSize,search:this.searchContent};this.doGetBaseFields(l)},handleClose(e){this.dialogVisible=!1},onSubmit(l){this.$refs[l].validate((t=>{if(!t)return!1;{let t={};t.key=this.addTmplFields.key,t.value=this.addTmplFields.value,"创建"===this.buttonTitle?(t.enabled=!0,(i=t,e({url:"/v1/base/fields",method:"post",data:i})).then((e=>{this.$notify({title:"成功",message:"创建成功！",type:"success"}),this.doGetBaseFields(),this.dialogVisible=!1,this.$refs[l].resetFields()})).catch((e=>{console.log(e)}))):(t.id=this.addTmplFields.id,function(l){return e({url:"/v1/base/fields",method:"put",data:l})}(t).then((e=>{this.$notify({title:"成功",message:"更新成功！",type:"success"}),this.doGetBaseFields(),this.dialogVisible=!1,this.$refs[l].resetFields()})).catch((e=>{console.log(e)})))}var i}))},onCancel(e){this.dialogVisible=!1,this.$refs[e].resetFields()},onSearch(){this.doGetBaseFields()},parseTimeSelf(e){var l=new Date(Date.parse(e));return l.toLocaleDateString()+" "+l.toTimeString().split(" ")[0]},doYes(l){var t;(t={id:l.row.id},e({url:"/v1/base/fields",method:"delete",params:t})).then((e=>{this.$notify({title:"成功",message:"删除成功！",type:"success"}),this.doGetBaseFields()})).catch((e=>{console.log(e)})),this.deleteVisible[l.$index]=!1},doNo(e){this.deleteVisible[e.$index]=!1},doDelete(e){this.deleteVisible[e.$index]=!0},rowStyle:e=>({padding:"0"}),cellStyle:e=>({padding:"0"}),invocate(l){const t=!this.tmplFields[l.$index].enabled,i={id:l.row.id,enabled:t};var a;(a=i,e({url:"/v1/base/fields/status",method:"put",data:a})).then((e=>{this.$notify({title:"成功",message:"更新状态成功！",type:"success"}),this.tmplFields[l.$index].enabled=t,this.tmplFields=[...this.tmplFields]})).catch((e=>console.log(e)))}}},c=u();l("data-v-35278a86");const m={class:"tmpl-field-board"},g={class:"btn-action-area"},b={class:"explain-words"},f=n("说明：这儿定义的字段（key/value）可以在"),v=n("模块编辑"),y=n("中使用，语法请参考golang中的"),C=n("text/template"),F={class:"do_action"},k={style:{"padding-right":"15px"}},z=n("添加模板字段"),T={class:"actioneara"},_=n("编辑"),w=n("禁用"),S=n("启用"),V=d("p",null,"确定删除吗？",-1),x={style:{"text-align":"right",margin:"0"}},$=n("取消"),B=n("确定"),G=n("删除"),N={class:"block"},j=n("取消");t();const D=c(((e,l,t,u,h,D)=>{const P=i("el-tag"),q=i("el-link"),E=i("el-button"),U=i("el-input"),A=i("el-table-column"),Y=i("el-popover"),I=i("el-table"),K=i("el-pagination"),L=i("el-form-item"),H=i("el-form"),J=i("el-dialog");return a(),s("div",m,[d("div",g,[d("div",null,[d("span",b,[f,d(P,{size:"mini"},{default:c((()=>[v])),_:1}),y,d(q,{href:"https://pkg.go.dev/text/template",target:"_blank",type:"warning"},{default:c((()=>[C])),_:1})])]),d("div",F,[d("div",k,[d(E,{size:"small",type:"success",plain:"",onClick:l[1]||(l[1]=e=>D.doAdd())},{default:c((()=>[z])),_:1})]),d("div",null,[d("div",null,[d(U,{size:"small",placeholder:"请输入内容",modelValue:h.searchContent,"onUpdate:modelValue":l[3]||(l[3]=e=>h.searchContent=e),onKeyup:l[4]||(l[4]=o((e=>D.onSearch()),["enter"]))},{append:c((()=>[d(E,{size:"small",onClick:l[2]||(l[2]=e=>D.onSearch()),icon:"el-icon-search"})])),_:1},8,["modelValue"])])])])]),d(I,{size:"mini","highlight-current-row":"",border:"",data:h.tmplFields,stripe:"","row-style":D.rowStyle,"cell-style":D.cellStyle},{default:c((()=>[d(A,{label:"序号",width:"50px"},{default:c((e=>[n(r(e.$index+1),1)])),_:1}),d(A,{label:"模板字段名称",prop:"key"}),d(A,{label:"模板字段值",prop:"value"}),d(A,{label:"最后更新账号",prop:"update_by"}),d(A,{label:"最后更新时间",prop:"update_at"},{default:c((({row:e})=>[d("span",null,r(D.parseTimeSelf(e.update_at)),1)])),_:1}),d(A,{label:"操作",align:"center",width:"210px"},{default:c((e=>[d("div",T,[d("div",null,[d(E,{size:"mini",type:"primary",onClick:l=>D.doEdit(e),plain:""},{default:c((()=>[_])),_:2},1032,["onClick"])]),d("div",null,[!0===e.row.enabled?(a(),s(E,{key:0,size:"mini",type:"info",onClick:l=>D.invocate(e),plain:""},{default:c((()=>[w])),_:2},1032,["onClick"])):p("",!0),!1===e.row.enabled?(a(),s(E,{key:1,size:"mini",type:"warning",onClick:l=>D.invocate(e),plain:""},{default:c((()=>[S])),_:2},1032,["onClick"])):p("",!0)]),d("div",null,[d(Y,{visible:h.deleteVisible[e.$index],placement:"top"},{reference:c((()=>[d(E,{size:"mini",type:"danger",plain:"",onClick:l=>D.doDelete(e)},{default:c((()=>[G])),_:2},1032,["onClick"])])),default:c((()=>[V,d("div",x,[d(E,{size:"mini",type:"text",onClick:l=>D.doNo(e)},{default:c((()=>[$])),_:2},1032,["onClick"]),d(E,{type:"primary",size:"mini",onClick:l=>D.doYes(e)},{default:c((()=>[B])),_:2},1032,["onClick"])])])),_:2},1032,["visible"])])])])),_:1})])),_:1},8,["data","row-style","cell-style"]),d("div",N,[d(K,{onSizeChange:D.handleSizeChange,onCurrentChange:D.handleCurrentChange,"current-page":h.currentPage,"page-sizes":[10,15,30,50],"page-size":h.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:h.pageTotal},null,8,["onSizeChange","onCurrentChange","current-page","page-size","total"])]),d(J,{title:h.dialogTitle,modelValue:h.dialogVisible,"onUpdate:modelValue":l[9]||(l[9]=e=>h.dialogVisible=e),width:"400px",modal:"","before-close":D.handleClose},{default:c((()=>[d("span",null,[d(H,{"label-position":"right",rules:h.rules,ref:"addTmplFields",model:h.addTmplFields,"label-width":"auto",size:"small"},{default:c((()=>[d(L,{label:"字段名称：",prop:"key"},{default:c((()=>[d(U,{style:{width:"250px"},modelValue:h.addTmplFields.key,"onUpdate:modelValue":l[5]||(l[5]=e=>h.addTmplFields.key=e)},null,8,["modelValue"])])),_:1}),d(L,{label:"字段值：",prop:"value"},{default:c((()=>[d(U,{style:{width:"250px"},modelValue:h.addTmplFields.value,"onUpdate:modelValue":l[6]||(l[6]=e=>h.addTmplFields.value=e)},null,8,["modelValue"])])),_:1}),d(L,{size:"small"},{default:c((()=>[d(E,{size:"small",type:"primary",onClick:l[7]||(l[7]=e=>D.onSubmit("addTmplFields"))},{default:c((()=>[n(r(h.buttonTitle),1)])),_:1}),d(E,{size:"small",type:"info",onClick:l[8]||(l[8]=e=>D.onCancel("addTmplFields"))},{default:c((()=>[j])),_:1})])),_:1})])),_:1},8,["rules","model"])])])),_:1},8,["title","modelValue","before-close"])])}));h.render=D,h.__scopeId="data-v-35278a86";export default h;
