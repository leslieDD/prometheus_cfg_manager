import{s as e}from"./request.6f2158d7.js";import{p as l,j as a,r as t,o as i,c as s,a as o,w as d,l as n,t as r,q as b,k as h}from"./vendor.02dbbba7.js";import"./index.8d374c5c.js";const c={name:"baseLabels",data:()=>({baseLabels:[],addLabelInfo:{id:0,label:""},pageSize:15,pageTotal:0,currentPage:1,searchContent:"",deleteVisible:{},dialogVisible:!1,buttonTitle:"",dialogTitle:"",rules:{label:[{required:!0,message:"请输入正确的标签名称",validator:function(e,l,a){if(""===l||void 0===l||null==l)a(new Error("请输入正确名称"));else{/\s+/.test(l)?a(new Error("名称中不允许有空字符")):a()}},trigger:["blur"]}]}}),created(){},mounted(){this.doGetBaseLabels()},methods:{doAdd(){this.addLabelInfo={label:"",port:0,display_order:1},this.buttonTitle="创建",this.dialogTitle="增加标签",this.dialogVisible=!0},doGetBaseLabels(l){var a;l||(l={pageNo:this.currentPage,pageSize:this.pageSize,search:this.searchContent}),(a=l,e({url:"/v1/base/labels",method:"get",params:a})).then((e=>{this.baseLabels=e.data.data,this.pageTotal=e.data.totalCount,this.currentPage=e.data.pageNo,this.pageSize=e.data.pageSize})).catch((e=>{console.log(e)}))},doEdit(e){this.buttonTitle="更新",this.dialogTitle="编辑标签",this.addLabelInfo.id=e.row.id,this.addLabelInfo.label=e.row.label,this.dialogVisible=!0},handleSizeChange(e){let l={pageNo:this.currentPage,pageSize:e,search:this.searchContent};this.doGetBaseLabels(l)},handleCurrentChange(e){let l={pageNo:e,pageSize:this.pageSize,search:this.searchContent};this.doGetBaseLabels(l)},handleClose(e){this.dialogVisible=!1},onSubmit(l){this.$refs[l].validate((a=>{if(!a)return!1;{let a={};a.label=this.addLabelInfo.label,"创建"===this.buttonTitle?(t=a,e({url:"/v1/base/labels",method:"post",data:t})).then((e=>{this.$notify({title:"成功",message:"创建成功！",type:"success"}),this.doGetBaseLabels(),this.dialogVisible=!1,this.$refs[l].resetFields()})).catch((e=>{console.log(e)})):(a.id=this.addLabelInfo.id,function(l){return e({url:"/v1/base/labels",method:"put",data:l})}(a).then((e=>{this.$notify({title:"成功",message:"更新成功！",type:"success"}),this.doGetBaseLabels(),this.dialogVisible=!1,this.$refs[l].resetFields()})).catch((e=>{console.log(e)})))}var t}))},onCancel(e){this.dialogVisible=!1,this.$refs[e].resetFields()},onSearch(){this.doGetBaseLabels()},parseTimeSelf(e){var l=new Date(Date.parse(e));return l.toLocaleDateString()+" "+l.toTimeString().split(" ")[0]},doYes(l){var a;(a={id:l.row.id},e({url:"/v1/base/labels",method:"delete",params:a})).then((e=>{this.$notify({title:"成功",message:"删除成功！",type:"success"}),this.doGetBaseLabels()})).catch((e=>{console.log(e)})),this.deleteVisible[l.$index]=!1},doNo(e){this.deleteVisible[e.$index]=!1},doDelete(e){this.deleteVisible[e.$index]=!0},rowStyle:e=>({padding:"0"}),cellStyle:e=>({padding:"0"}),invocate(l){const a=!this.baseLabels[l.$index].enabled,t={id:l.row.id,enabled:a};var i;(i=t,e({url:"/v1/base/labels/status",method:"put",data:i})).then((e=>{this.$notify({title:"成功",message:"更新状态成功！",type:"success"}),this.baseLabels[l.$index].enabled=a,this.baseLabels=[...this.baseLabels]})).catch((e=>console.log(e)))}}},p=h();l("data-v-1b2e1236");const u={class:"main-board"},g={class:"btn-action-area"},m={class:"explain-words"},f=n(" 说明：定义的标签（key/value）可以在"),C=n("JOB组管理"),y=n("和"),v=n("告警管理"),z=n("中使用"),L={class:"do_action"},_={style:{"padding-right":"15px"}},S=n("添加标签"),w={class:"actioneara"},V=n("编辑"),k=n("禁用"),x=n("启用"),T=o("p",null,"确定删除吗？",-1),$={style:{"text-align":"right",margin:"0"}},I=n("取消"),B=n("确定"),G=n("删除"),N={class:"block"},j=n("取消");a();const D=p(((e,l,a,h,c,D)=>{const P=t("el-tag"),E=t("el-button"),q=t("el-input"),F=t("el-table-column"),U=t("el-popover"),A=t("el-table"),Y=t("el-pagination"),J=t("el-form-item"),K=t("el-form"),O=t("el-dialog");return i(),s("div",u,[o("div",g,[o("div",null,[o("span",m,[f,o(P,{size:"mini"},{default:p((()=>[C])),_:1}),y,o(P,{size:"mini"},{default:p((()=>[v])),_:1}),z])]),o("div",L,[o("div",_,[o(E,{size:"small",type:"success",plain:"",onClick:l[1]||(l[1]=e=>D.doAdd())},{default:p((()=>[S])),_:1})]),o("div",null,[o("div",null,[o(q,{size:"small",placeholder:"请输入内容",modelValue:c.searchContent,"onUpdate:modelValue":l[3]||(l[3]=e=>c.searchContent=e),onKeyup:l[4]||(l[4]=d((e=>D.onSearch()),["enter"]))},{append:p((()=>[o(E,{size:"small",onClick:l[2]||(l[2]=e=>D.onSearch()),icon:"el-icon-search"})])),_:1},8,["modelValue"])])])])]),o(A,{size:"mini","highlight-current-row":"",border:"",data:c.baseLabels,stripe:"","row-style":D.rowStyle,"cell-style":D.cellStyle},{default:p((()=>[o(F,{label:"序号",width:"50px"},{default:p((e=>[n(r(e.$index+1),1)])),_:1}),o(F,{label:"标签名称",prop:"label"}),o(F,{label:"最后更新账号",prop:"update_by"}),o(F,{label:"最后更新时间",prop:"update_at"},{default:p((({row:e})=>[o("span",null,r(D.parseTimeSelf(e.update_at)),1)])),_:1}),o(F,{label:"操作",align:"center",width:"210px"},{default:p((e=>[o("div",w,[o("div",null,[o(E,{size:"mini",type:"primary",onClick:l=>D.doEdit(e),plain:""},{default:p((()=>[V])),_:2},1032,["onClick"])]),o("div",null,[!0===e.row.enabled?(i(),s(E,{key:0,size:"mini",type:"info",onClick:l=>D.invocate(e),plain:""},{default:p((()=>[k])),_:2},1032,["onClick"])):b("",!0),!1===e.row.enabled?(i(),s(E,{key:1,size:"mini",type:"warning",onClick:l=>D.invocate(e),plain:""},{default:p((()=>[x])),_:2},1032,["onClick"])):b("",!0)]),o("div",null,[o(U,{visible:c.deleteVisible[e.$index],placement:"top"},{reference:p((()=>[o(E,{size:"mini",type:"danger",plain:"",onClick:l=>D.doDelete(e)},{default:p((()=>[G])),_:2},1032,["onClick"])])),default:p((()=>[T,o("div",$,[o(E,{size:"mini",type:"text",onClick:l=>D.doNo(e)},{default:p((()=>[I])),_:2},1032,["onClick"]),o(E,{type:"primary",size:"mini",onClick:l=>D.doYes(e)},{default:p((()=>[B])),_:2},1032,["onClick"])])])),_:2},1032,["visible"])])])])),_:1})])),_:1},8,["data","row-style","cell-style"]),o("div",N,[o(Y,{onSizeChange:D.handleSizeChange,onCurrentChange:D.handleCurrentChange,"current-page":c.currentPage,"page-sizes":[10,15,30,50],"page-size":c.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:c.pageTotal},null,8,["onSizeChange","onCurrentChange","current-page","page-size","total"])]),o(O,{title:c.dialogTitle,modelValue:c.dialogVisible,"onUpdate:modelValue":l[8]||(l[8]=e=>c.dialogVisible=e),width:"400px",modal:"","before-close":D.handleClose},{default:p((()=>[o("span",null,[o(K,{"label-position":"right",rules:c.rules,ref:"addLabelInfo",model:c.addLabelInfo,"label-width":"90px",size:"small"},{default:p((()=>[o(J,{label:"标签名：",prop:"label"},{default:p((()=>[o(q,{style:{width:"230px"},modelValue:c.addLabelInfo.label,"onUpdate:modelValue":l[5]||(l[5]=e=>c.addLabelInfo.label=e)},null,8,["modelValue"])])),_:1}),o(J,{size:"small"},{default:p((()=>[o(E,{size:"small",type:"primary",onClick:l[6]||(l[6]=e=>D.onSubmit("addLabelInfo"))},{default:p((()=>[n(r(c.buttonTitle),1)])),_:1}),o(E,{size:"small",type:"info",onClick:l[7]||(l[7]=e=>D.onCancel("addLabelInfo"))},{default:p((()=>[j])),_:1})])),_:1})])),_:1},8,["rules","model"])])])),_:1},8,["title","modelValue","before-close"])])}));c.render=D,c.__scopeId="data-v-1b2e1236";export default c;
