var e=Object.defineProperty,a=Object.getOwnPropertySymbols,l=Object.prototype.hasOwnProperty,t=Object.prototype.propertyIsEnumerable,i=(a,l,t)=>l in a?e(a,l,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[l]=t,s=(e,s)=>{for(var o in s||(s={}))l.call(s,o)&&i(e,o,s[o]);if(a)for(var o of a(s))t.call(s,o)&&i(e,o,s[o]);return e};import{g as o,a as r,p as n,b as d,d as p,e as u}from"./manager.b6c9f382.js";import{p as g,j as h,r as c,o as m,c as b,a as f,w,l as y,t as C,q as _,F as U,n as V,k as v}from"./vendor.684f159e.js";import"./request.c24bac87.js";import"./index.6f2c4da2.js";const M={name:"ManagerUser",data:()=>({value:"",ManagerGroup:[],ManagerUser:[],ManagerUserRef:{id:0,username:"",password:"",group_id:null,phone:""},editCodeButVisable:{},pageSize:20,pageTotal:0,currentPage:1,searchContent:"",deleteVisible:{},dialogVisible:!1,buttonTitle:"",dialogTitle:"",rules:{username:[{required:!0,message:"请输入正确的名称",validator:function(e,a,l){if(""===a||void 0===a||null==a)l(new Error("请输入正确名称"));else{/\s+/.test(a)?l(new Error("名称中不允许有空字符")):l()}},trigger:["blur"]}],password:[{required:!0,message:"请输入密码",trigger:["blur"]}],group_id:[{required:!0,message:"请选择组",trigger:["blur"]}]},paginationShow:!0}),mounted(){this.$route.params.group_name&&(this.searchContent=this.$route.params.group_name),this.doGetManagerUser()},methods:{doAdd(){this.ManagerUserRef={id:0,username:"",password:"",group_id:null,phone:""},o().then((e=>{this.ManagerGroup=e.data,this.buttonTitle="创建",this.dialogTitle="增加用户",this.dialogVisible=!0})).catch((e=>console.log(e)))},doGetManagerUser(e){e||(e={pageNo:this.currentPage,pageSize:this.pageSize,search:this.searchContent}),r(e).then((e=>{this.ManagerUser=e.data.data,this.pageTotal=e.data.totalCount,this.currentPage=e.data.pageNo,this.pageSize=e.data.pageSize,this.paginationShow=!1,this.$nextTick((()=>{this.paginationShow=!0}))})).catch((e=>{console.log(e)}))},doEdit(e){o().then((a=>{this.ManagerGroup=a.data,this.buttonTitle="更新",this.dialogTitle="编辑用户",this.ManagerUserRef=s({},e.row),this.dialogVisible=!0})).catch((e=>console.log(e)))},handleSizeChange(e){let a={pageNo:this.currentPage,pageSize:e,search:this.searchContent};this.doGetManagerUser(a)},handleCurrentChange(e){let a={pageNo:e,pageSize:this.pageSize,search:this.searchContent};this.doGetManagerUser(a)},handleClose(e){this.dialogVisible=!1},onSubmit(e){this.$refs[e].validate((a=>{if(!a)return!1;{const a=s({},this.ManagerUserRef);"创建"===this.buttonTitle||"create"===this.buttonTitle?n(a).then((a=>{this.$notify({title:"成功",message:"创建成功！",type:"success"}),this.doGetManagerUser(),this.dialogVisible=!1,this.$refs[e].resetFields()})).catch((e=>{console.log(e)})):d(a).then((a=>{this.$notify({title:"成功",message:"更新成功！",type:"success"}),this.doGetManagerUser(),this.dialogVisible=!1,this.$refs[e].resetFields()})).catch((e=>{console.log(e)}))}}))},onCancel(e){this.dialogVisible=!1,this.$refs[e].resetFields()},onSearch(){this.doGetManagerUser()},parseTimeSelf(e){var a=new Date(Date.parse(e));return a.toLocaleDateString()+" "+a.toTimeString().split(" ")[0]},doYes(e){p({id:e.row.id}).then((e=>{this.$notify({title:"成功",message:"删除成功！",type:"success"}),this.doGetManagerUser()})).catch((e=>{console.log(e)})),this.deleteVisible[e.$index]=!1},doNo(e){this.deleteVisible[e.$index]=!1},doDelete(e){this.deleteVisible[e.$index]=!0},rowStyle:e=>({padding:"0"}),cellStyle:e=>({padding:"0"}),invocate(e){const a=!this.ManagerUser[e.$index].enabled,l={id:e.row.id,enabled:a};u(l).then((l=>{this.$notify({title:"成功",message:"更新状态成功！",type:"success"}),this.ManagerUser[e.$index].enabled=a,this.ManagerUser=[...this.ManagerUser]})).catch((e=>console.log(e)))},routeToGroup(e){this.$router.push({name:"group",params:{group_name:e.group_name}})}}},z=v();g("data-v-5438f20c");const S={class:"user-board"},x={class:"main-content"},k={class:"do_action"},T={style:{"padding-right":"15px"}},$=y("添加用户"),R={class:"table-show"},G={class:"actioneara"},j=y("编辑"),P=y("禁用"),N=y("启用"),O=f("p",null,"确定删除吗？",-1),q={style:{"text-align":"right",margin:"0"}},B=y("取消"),D=y("确定"),E=y("删除"),F={key:0,class:"block"},A=y("取消");h();const I=z(((e,a,l,t,i,s)=>{const o=c("el-button"),r=c("el-input"),n=c("el-table-column"),d=c("el-popover"),p=c("el-table"),u=c("el-pagination"),g=c("el-scrollbar"),h=c("el-form-item"),v=c("el-option"),M=c("el-select"),I=c("el-form"),Y=c("el-dialog");return m(),b("div",S,[f("div",x,[f("div",null,[f("div",k,[f("div",T,[f(o,{size:"small",type:"success",plain:"",onClick:a[1]||(a[1]=e=>s.doAdd())},{default:z((()=>[$])),_:1})]),f("div",null,[f(r,{size:"small",placeholder:"请输入内容",onKeyup:a[3]||(a[3]=w((e=>s.onSearch()),["enter"])),modelValue:i.searchContent,"onUpdate:modelValue":a[4]||(a[4]=e=>i.searchContent=e)},{append:z((()=>[f(o,{size:"small",onClick:a[2]||(a[2]=e=>s.onSearch()),icon:"el-icon-search"})])),_:1},8,["modelValue"])])]),f("div",R,[f(g,{height:"75vh",class:"flex-content"},{default:z((()=>[f(p,{size:"mini","highlight-current-row":"",border:"",data:i.ManagerUser,stripe:"","row-style":s.rowStyle,"cell-style":s.cellStyle},{default:z((()=>[f(n,{label:"序号",width:"50px"},{default:z((e=>[y(C(e.$index+1),1)])),_:1}),f(n,{label:"用户名",prop:"username"}),f(n,{label:"密码",width:"280px","show-overflow-tooltip":"",prop:"password"}),f(n,{label:"手机",prop:"phone"}),f(n,{label:"所属组",prop:"group_name"},{default:z((({row:e})=>[f(o,{size:"mini",onClick:a=>s.routeToGroup(e),type:"text"},{default:z((()=>[y(C(e.group_name),1)])),_:2},1032,["onClick"])])),_:1}),f(n,{label:"最后更新时间",width:"130px",prop:"update_at"},{default:z((({row:e})=>[f("span",null,C(s.parseTimeSelf(e.update_at)),1)])),_:1}),f(n,{label:"操作",align:"center",width:"200px"},{default:z((e=>[f("div",G,[f("div",null,[f(o,{size:"mini",type:"primary",onClick:a=>s.doEdit(e),plain:"",disabled:i.editCodeButVisable[e.row.id]},{default:z((()=>[j])),_:2},1032,["onClick","disabled"])]),f("div",null,[!0===e.row.enabled?(m(),b(o,{key:0,size:"mini",type:"info",onClick:a=>s.invocate(e),plain:"",disabled:i.editCodeButVisable[e.row.id]},{default:z((()=>[P])),_:2},1032,["onClick","disabled"])):_("",!0),!1===e.row.enabled?(m(),b(o,{key:1,size:"mini",type:"warning",onClick:a=>s.invocate(e),plain:"",disabled:i.editCodeButVisable[e.row.id]},{default:z((()=>[N])),_:2},1032,["onClick","disabled"])):_("",!0)]),f("div",null,[f(d,{visible:i.deleteVisible[e.$index],placement:"top"},{reference:z((()=>[f(o,{size:"mini",type:"danger",plain:"",onClick:a=>s.doDelete(e),disabled:i.editCodeButVisable[e.row.id]},{default:z((()=>[E])),_:2},1032,["onClick","disabled"])])),default:z((()=>[O,f("div",q,[f(o,{size:"mini",type:"text",onClick:a=>s.doNo(e)},{default:z((()=>[B])),_:2},1032,["onClick"]),f(o,{type:"primary",size:"mini",onClick:a=>s.doYes(e)},{default:z((()=>[D])),_:2},1032,["onClick"])])])),_:2},1032,["visible"])])])])),_:1})])),_:1},8,["data","row-style","cell-style"]),i.paginationShow?(m(),b("div",F,[f(u,{onSizeChange:s.handleSizeChange,onCurrentChange:s.handleCurrentChange,"current-page":i.currentPage,"page-sizes":[20,30,50],"page-size":i.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:i.pageTotal},null,8,["onSizeChange","onCurrentChange","current-page","page-size","total"])])):_("",!0)])),_:1})])])]),f(Y,{title:i.dialogTitle,modelValue:i.dialogVisible,"onUpdate:modelValue":a[11]||(a[11]=e=>i.dialogVisible=e),width:"410px",modal:"","before-close":s.handleClose},{default:z((()=>[f("span",null,[f(I,{"label-position":"right",rules:i.rules,ref:"ManagerUserRef",model:i.ManagerUserRef,"label-width":"auto",size:"small"},{default:z((()=>[f(h,{label:"用户名：",prop:"username"},{default:z((()=>[f(r,{style:{width:"280px"},modelValue:i.ManagerUserRef.username,"onUpdate:modelValue":a[5]||(a[5]=e=>i.ManagerUserRef.username=e)},null,8,["modelValue"])])),_:1}),f(h,{label:"密码：",prop:"password"},{default:z((()=>[f(r,{type:"password",style:{width:"280px"},modelValue:i.ManagerUserRef.password,"onUpdate:modelValue":a[6]||(a[6]=e=>i.ManagerUserRef.password=e)},null,8,["modelValue"])])),_:1}),f(h,{label:"手机：",prop:"phone"},{default:z((()=>[f(r,{style:{width:"280px"},modelValue:i.ManagerUserRef.phone,"onUpdate:modelValue":a[7]||(a[7]=e=>i.ManagerUserRef.phone=e)},null,8,["modelValue"])])),_:1}),f(h,{label:"所属组：",prop:"group_id"},{default:z((()=>[f(M,{modelValue:i.ManagerUserRef.group_id,"onUpdate:modelValue":a[8]||(a[8]=e=>i.ManagerUserRef.group_id=e),class:"borderNone","popper-class":"pppselect",size:"small","collapse-tags":"",placeholder:"请选择",style:{width:"280px"}},{default:z((()=>[(m(!0),b(U,null,V(i.ManagerGroup,(e=>(m(),b(v,{style:{width:"280px"},key:e.id,label:e.name,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),f(h,{size:"small"},{default:z((()=>[f(o,{size:"small",type:"primary",onClick:a[9]||(a[9]=e=>s.onSubmit("ManagerUserRef"))},{default:z((()=>[y(C(i.buttonTitle),1)])),_:1}),f(o,{size:"small",type:"info",onClick:a[10]||(a[10]=e=>s.onCancel("ManagerUserRef"))},{default:z((()=>[A])),_:1})])),_:1})])),_:1},8,["rules","model"])])])),_:1},8,["title","modelValue","before-close"])])}));M.render=I,M.__scopeId="data-v-5438f20c";export default M;
